<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Building the Coinbase Transaction</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=Space+Grotesk:wght@500;700&amp;family=JetBrains+Mono:wght@400;500&amp;display=swap" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
    :root {
        --cyan-400: #22d3ee;
        --cyan-500: #06b6d4;
        --cyan-600: #0891b2;
        --blue-600: #2563eb;
    }
    body {
        width: 1280px; height: 720px; overflow: hidden;
        font-family: 'Inter', sans-serif;
        background-color: #09090b;
        color: #F8FAFC; position: relative;
    }
        50%       { opacity: 0.06; transform: scale(1.04); }
    }

    .bg-grid {
        position: absolute; inset: 0; z-index: 1;
        background-image:
            linear-gradient(rgba(6, 182, 212, 0.07) 1px, transparent 1px),
            linear-gradient(90deg, rgba(6, 182, 212, 0.07) 1px, transparent 1px);
        background-size: 30px 30px; opacity: 0.5;
    }

    .mono-font { font-family: 'JetBrains Mono', monospace; }

    .glass-panel {
        background: rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(6, 182, 212, 0.18);
    }

    /* Step badge */
    .step-badge {
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.62rem; font-weight: bold;
        padding: 1px 7px; border-radius: 3px;
        background: rgba(6,182,212,0.15);
        border: 1px solid rgba(6,182,212,0.3);
        color: var(--cyan-400);
        letter-spacing: 0.06em;
        margin-right: 0.6rem;
        flex-shrink: 0;
    }

    /* Coinbase field rows */
    .cb-field {
        display: flex; align-items: center; gap: 0.75rem;
    }
    .cb-label {
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.65rem; text-align: right;
        flex-shrink: 0; width: 110px;
        color: rgba(148,163,184,0.6);
    }
    .cb-bar {
        flex: 1; border-radius: 6px; padding: 0.6rem 1rem;
        font-family: 'JetBrains Mono', monospace; font-size: 0.82rem;
        font-weight: 500;
    }
</style>
</head>
<body class="relative flex flex-col justify-between">

<!-- Gradient orbs -->
<div class="bg-grid"></div>

<!-- Header -->
<header class="relative z-10 px-16 pt-9 pb-4 flex items-end justify-between"
        style="border-bottom: 1px solid rgba(6,182,212,0.2); background: rgba(0,0,0,0.5);">
    <div>
        <div class="flex items-center space-x-3 mb-2">
            <span class="px-2 py-1 text-xs font-bold rounded mono-font"
                  style="background: rgba(6,182,212,0.15); color: #22d3ee; border: 1px solid rgba(6,182,212,0.3);">
                PROTOCOL OPERATIONS
            </span>
            <span class="text-xs mono-font" style="color: rgba(6,182,212,0.5);">// MINER SIDE</span>
        </div>
        <h1 class="text-4xl font-black tracking-tight text-white uppercase"
            style="font-family: 'Space Grotesk', sans-serif; letter-spacing: -0.02em;">
            Building the <span style="color: var(--cyan-400);">Coinbase Tx</span>
        </h1>
    </div>
    <div class="text-right">
        <p class="text-sm max-w-md text-right mono-font" style="color: rgba(148,163,184,0.7);">
            The miner assembles the coinbase transaction locally to enable extranonce searching.
        </p>
    </div>
</header>

<!-- Main Content -->
<main class="relative z-10 flex-1 px-16 py-6 flex gap-10 overflow-hidden">

    <!-- Left Column: Steps -->
    <div class="flex-1 flex flex-col justify-center space-y-4">

        <!-- Step 1 -->
        <div class="glass-panel p-5 rounded-xl" style="border-left: 3px solid var(--cyan-500);">
            <h3 class="flex items-center text-base font-bold mb-2" style="color: var(--cyan-400); font-family: 'Space Grotesk', sans-serif;">
                <span class="step-badge">STEP 1</span> Generate Extranonce2
            </h3>
            <p class="text-sm leading-relaxed mb-2" style="color: rgba(211,225,239,0.85);">
                The miner generates a unique <code class="mono-font" style="color: var(--cyan-400);">extranonce2</code>.
            </p>
            <ul class="text-xs space-y-1 ml-1" style="color: rgba(148,163,184,0.75);">
                <li class="flex items-start gap-1.5"><span style="color: var(--cyan-500);">·</span> Must match length from <code class="mono-font" style="color: rgba(34,211,238,0.7);">extranonce2_size</code> (e.g., 4 bytes).</li>
                <li class="flex items-start gap-1.5"><span style="color: var(--cyan-500);">·</span> Unique per <code class="mono-font" style="color: rgba(34,211,238,0.7);">job_id</code> to avoid duplicate shares.</li>
                <li class="flex items-start gap-1.5"><span style="color: var(--cyan-500);">·</span> Incremented when 32-bit nonce overflows.</li>
            </ul>
        </div>

        <!-- Step 2 -->
        <div class="glass-panel p-5 rounded-xl" style="border-left: 3px solid var(--cyan-400);">
            <h3 class="flex items-center text-base font-bold mb-2" style="color: var(--cyan-400); font-family: 'Space Grotesk', sans-serif;">
                <span class="step-badge">STEP 2</span> Concatenate Components
            </h3>
            <p class="text-sm leading-relaxed mb-3" style="color: rgba(211,225,239,0.85);">
                Combine parts from the pool with the locally generated extranonce.
            </p>
            <div class="mono-font text-sm p-3 rounded" style="background: rgba(0,0,0,0.5); border: 1px solid rgba(6,182,212,0.2);">
                <span style="color: rgba(148,163,184,0.5);">Coinbase = </span><span style="color: #fde68a;">Coinb1</span>
                <span style="color: rgba(148,163,184,0.4);"> + </span><span style="color: var(--cyan-400);">Extranonce1</span>
                <span style="color: rgba(148,163,184,0.4);"> + </span><span style="color: #86efac;">Extranonce2</span>
                <span style="color: rgba(148,163,184,0.4);"> + </span><span style="color: #fde68a;">Coinb2</span>
            </div>
        </div>

        <!-- Step 3 -->
        <div class="glass-panel p-5 rounded-xl" style="border-left: 3px solid rgba(6,182,212,0.35);">
            <h3 class="flex items-center text-base font-bold mb-2" style="color: rgba(34,211,238,0.7); font-family: 'Space Grotesk', sans-serif;">
                <span class="step-badge">STEP 3</span> Calculate Merkle Root
            </h3>
            <p class="text-sm leading-relaxed" style="color: rgba(148,163,184,0.8);">
                Hash the coinbase transaction to get the TXID, then compute the Merkle Root using <code class="mono-font" style="color: var(--cyan-400);">merkle_branches</code> from the notify message.
            </p>
        </div>

    </div>

    <!-- Right Column: Diagram -->
    <div class="flex-1 flex flex-col">
        <div class="glass-panel p-5 rounded-xl flex flex-col h-full">
            <h4 class="text-base font-bold mb-4 flex-shrink-0 mono-font"
                style="color: var(--cyan-400); border-bottom: 1px solid rgba(6,182,212,0.15); padding-bottom: 0.6rem;">
                Data Structure Visualization
            </h4>
            <div class="flex-1 flex flex-col justify-center space-y-3">

                <!-- Coinb1 -->
                <div class="cb-field">
                    <div class="cb-label">From Pool</div>
                    <div class="cb-bar" style="background: rgba(253,230,138,0.08); border: 1px solid rgba(253,230,138,0.3); color: #fde68a;">
                        Coinb1 — Input Script Start
                    </div>
                </div>

                <!-- Extranonce1 -->
                <div class="cb-field">
                    <div class="cb-label">Subscribe Resp.</div>
                    <div class="cb-bar" style="background: rgba(6,182,212,0.08); border: 1px solid rgba(6,182,212,0.3); color: var(--cyan-400);">
                        Extranonce1 — Fixed per Connection
                    </div>
                </div>

                <!-- Extranonce2 -->
                <div class="cb-field">
                    <div class="cb-label" style="color: #86efac; font-weight: 600;">Miner Generated</div>
                    <div class="cb-bar" style="background: rgba(134,239,172,0.08); border: 1px solid rgba(134,239,172,0.4); color: #86efac; font-weight: 600; box-shadow: 0 0 12px rgba(134,239,172,0.1);">
                        Extranonce2 — Mutable ✦
                    </div>
                </div>

                <!-- Coinb2 -->
                <div class="cb-field">
                    <div class="cb-label">From Pool</div>
                    <div class="cb-bar" style="background: rgba(253,230,138,0.08); border: 1px solid rgba(253,230,138,0.3); color: #fde68a;">
                        Coinb2 — Output Script
                    </div>
                </div>

            </div>

            <!-- Why this matters -->
            <div class="mt-4 p-4 rounded-lg flex-shrink-0"
                 style="background: rgba(6,182,212,0.05); border: 1px solid rgba(6,182,212,0.18);">
                <div class="flex items-start gap-3">
                    <i class="fas fa-info-circle mt-0.5 flex-shrink-0" style="color: var(--cyan-500);"></i>
                    <div>
                        <h5 class="font-bold text-sm mb-1" style="color: var(--cyan-400); font-family: 'Space Grotesk', sans-serif;">Why this matters</h5>
                        <p class="text-xs leading-relaxed" style="color: rgba(148,163,184,0.75);">
                            Modifying <code class="mono-font" style="color: #86efac;">Extranonce2</code> changes the Coinbase TXID, which changes the Merkle Root — giving the miner a completely new block header and fresh 32-bit nonce space.
                        </p>
                    </div>
                </div>
            </div>

        </div>
    </div>

</main>
<script src="slides.js"></script>
<script src="navigate.js"></script>
</body>
</html>
