<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Attack 1: Job Injection via set_extranonce</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=Space+Grotesk:wght@500;700&amp;family=JetBrains+Mono:wght@400;500&amp;display=swap" rel="stylesheet"/>
<style>
    :root {
        --cyan-400: #22d3ee;
        --cyan-500: #06b6d4;
        --cyan-600: #0891b2;
        --blue-600: #2563eb;
    }
    body { margin:0; padding:0; overflow:hidden; background-color:#09090b; font-family:'Inter',sans-serif; }
        50%    { opacity:0.06; transform:scale(1.04); }
    }

    .bg-grid {
        position:absolute; inset:0; z-index:1;
        background-image:
            linear-gradient(rgba(6,182,212,0.07) 1px, transparent 1px),
            linear-gradient(90deg, rgba(6,182,212,0.07) 1px, transparent 1px);
        background-size:30px 30px; opacity:0.5;
    }

    .slide-container {
        width:1280px; height:720px;
        position:relative; display:flex; flex-direction:column;
        color:#F8FAFC; overflow:hidden;
    }

    .mono-font { font-family:'JetBrains Mono',monospace; }

    /* Timeline */
    .timeline-line {
        position:absolute; left:21px; top:0; bottom:0;
        width:2px;
        background:linear-gradient(to bottom, rgba(6,182,212,0.4), rgba(239,68,68,0.5), rgba(239,68,68,0.3));
        z-index:0;
    }

    /* Stage cards */
    .stage-card { display:flex; gap:1.2rem; z-index:1; position:relative; }

    .stage-marker {
        width:44px; height:44px; border-radius:50%;
        background:rgba(0,0,0,0.6);
        border:2px solid rgba(6,182,212,0.35);
        color:rgba(148,163,184,0.7);
        font-weight:bold; font-size:1.1rem;
        display:flex; align-items:center; justify-content:center;
        flex-shrink:0;
        font-family:'Space Grotesk',sans-serif;
    }
    .stage-active .stage-marker {
        background:rgba(69,10,10,0.7);
        border-color:#EF4444;
        color:#F87171;
        box-shadow:0 0 14px rgba(239,68,68,0.35);
    }

    .stage-content {
        flex:1;
        background:rgba(0,0,0,0.4);
        backdrop-filter:blur(8px);
        border:1px solid rgba(6,182,212,0.15);
        border-radius:0.6rem;
        padding:0.8rem 1rem;
    }
    .stage-active .stage-content {
        border-color:rgba(239,68,68,0.4);
        background:rgba(69,10,10,0.2);
    }

    .stage-title {
        font-family:'Space Grotesk',sans-serif;
        font-weight:700; font-size:0.97rem;
        color:#F8FAFC; margin-bottom:0.4rem;
        display:flex; justify-content:space-between; align-items:center;
    }
    .stage-active .stage-title { color:#F87171; }

    .code-preview {
        font-family:'JetBrains Mono',monospace;
        font-size:0.78rem;
        background:rgba(0,0,0,0.6);
        padding:0.45rem 0.75rem;
        border-radius:0.375rem;
        margin-top:0.4rem;
        border-left:3px solid;
        overflow:hidden; white-space:nowrap; text-overflow:ellipsis;
    }
    .code-normal   { border-color:rgba(6,182,212,0.6); color:rgba(34,211,238,0.8); }
    .code-malicious{ border-color:#EF4444; color:#FCA5A5; }

    .warning-badge {
        display:inline-block;
        background:#EF4444; color:white;
        font-size:0.65rem; font-weight:700;
        padding:2px 7px; border-radius:3px;
        text-transform:uppercase; letter-spacing:0.05em;
        font-family:'JetBrains Mono',monospace;
    }

    /* Right panel */
    .stat-grid { display:grid; grid-template-columns:1fr 1fr; gap:0.6rem; margin-top:0.75rem; }
    .stat-item {
        background:rgba(0,0,0,0.4); padding:0.65rem 0.5rem;
        border-radius:0.5rem; text-align:center;
        border:1px solid rgba(6,182,212,0.1);
    }
    .stat-label {
        font-family:'JetBrains Mono',monospace;
        font-size:0.65rem; color:rgba(148,163,184,0.6);
        text-transform:uppercase; letter-spacing:0.05em;
    }
    .stat-value {
        font-family:'Space Grotesk',sans-serif;
        font-size:1rem; font-weight:700; margin-top:0.2rem;
    }

    @keyframes pulse-dot {
        0%,100%{ opacity:1; transform:scale(1); }
        50%    { opacity:0.5; transform:scale(1.5); }
    }
    .pulse-dot {
        width:8px; height:8px; background:#EF4444; border-radius:50%;
        display:inline-block; margin-right:7px;
        animation:pulse-dot 1.5s infinite;
    }
</style>
</head>
<body>
<!-- Gradient orbs -->
<div class="bg-grid"></div>

<div class="slide-container">

<!-- Header -->
<div class="relative z-10 px-12 pt-7 pb-3 flex items-end justify-between"
     style="border-bottom:1px solid rgba(6,182,212,0.2); background:rgba(0,0,0,0.5);">
    <div>
        <div class="flex items-center space-x-3 mb-2">
            <span class="px-2 py-1 text-xs font-bold rounded mono-font"
                  style="background:rgba(239,68,68,0.12); color:#f87171; border:1px solid rgba(239,68,68,0.3);">
                ATTACK 1
            </span>
            <span class="text-xs mono-font" style="color:rgba(6,182,212,0.5);">// JOB INJECTION</span>
        </div>
        <h1 class="text-3xl font-black tracking-tight text-white uppercase"
            style="font-family:'Space Grotesk',sans-serif; letter-spacing:-0.02em;">
            Injection via <span style="color:#f87171;">set_extranonce</span>
        </h1>
    </div>
    <div class="text-right">
        <p class="text-sm mono-font" style="color:rgba(148,163,184,0.7);">
            Vulnerability: plaintext state mutation — no session binding
        </p>
    </div>
</div>

<!-- Main Content -->
<div class="relative z-10 flex-1 px-12 py-5 flex gap-8 overflow-hidden">

    <!-- Left Column: Attack Flow Timeline -->
    <div style="flex:1.2;" class="relative flex flex-col justify-between gap-3" style="padding-left:0;">

        <div class="timeline-line" style="left:21px;"></div>

        <!-- Stage 1 -->
        <div class="stage-card">
            <div class="stage-marker">1</div>
            <div class="stage-content">
                <div class="stage-title">Collection Phase</div>
                <p style="color:rgba(148,163,184,0.8); font-size:0.87rem; margin:0 0 0.4rem;">
                    MITM connects to both legitimate pool and evil pool to harvest subscription details.
                </p>
                <div class="code-preview code-normal">
                    LEGIT: extranonce1="a1b2", size=4<br/>
                    EVIL:  extranonce1="dead", size=4
                </div>
            </div>
        </div>

        <!-- Stage 2 -->
        <div class="stage-card">
            <div class="stage-marker">2</div>
            <div class="stage-content">
                <div class="stage-title">Normal Operation</div>
                <p style="color:rgba(148,163,184,0.8); font-size:0.87rem; margin:0 0 0.4rem;">
                    Forwards legitimate jobs to build miner trust. Miner works on correct pool data.
                </p>
                <div class="code-preview code-normal">
                    mining.notify(job_id_100, ...)
                </div>
            </div>
        </div>

        <!-- Stage 3 — active/attack -->
        <div class="stage-card stage-active">
            <div class="stage-marker">3</div>
            <div class="stage-content">
                <div class="stage-title">
                    Injection Attack <span class="warning-badge">CRITICAL</span>
                </div>
                <p style="color:#FCA5A5; font-size:0.87rem; margin:0 0 0.4rem;">
                    MITM injects <code class="mono-font" style="background:rgba(239,68,68,0.2); color:#f87171; padding:1px 5px; border-radius:3px; font-size:0.82rem;">set_extranonce</code> with malicious pool parameters.
                </p>
                <div class="code-preview code-malicious">
                    --&gt; mining.set_extranonce("dead", 4)<br/>
                    --&gt; mining.notify(job_id_evil, ...)
                </div>
            </div>
        </div>

        <!-- Stage 4 -->
        <div class="stage-card">
            <div class="stage-marker">4</div>
            <div class="stage-content">
                <div class="stage-title">Silent Redirect</div>
                <p style="color:rgba(148,163,184,0.8); font-size:0.87rem; margin:0;">
                    Miner constructs coinbase using evil pool's extranonce1. Work is now credited to the attacker — victim's hardware funds the theft.
                </p>
            </div>
        </div>

    </div>

    <!-- Right Column: Impact & Symptoms -->
    <div style="flex:0.85;" class="flex flex-col gap-4">

        <!-- Impact Assessment -->
        <div class="rounded-xl p-4"
             style="background:rgba(69,10,10,0.12); border:1px solid rgba(239,68,68,0.35);">
            <div class="flex items-center gap-2 mb-3"
                 style="font-family:'Space Grotesk',sans-serif; font-size:1.05rem; font-weight:700; color:#F87171;">
                <i class="fas fa-radiation-alt"></i> Impact Assessment
            </div>
            <p style="color:rgba(148,163,184,0.85); font-size:0.88rem; line-height:1.55; margin:0 0 0.5rem;">
                The miner is unaware of the switch because <code class="mono-font" style="color:#f87171; font-size:0.82rem;">set_extranonce</code> is a valid protocol message — designed for pool-side changes, not authenticated session binding.
            </p>
            <div class="stat-grid">
                <div class="stat-item">
                    <div class="stat-label">Detection</div>
                    <div class="stat-value" style="color:#F87171;">High</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Efficiency</div>
                    <div class="stat-value" style="color:#FDE68A;">Normal</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Work Theft</div>
                    <div class="stat-value" style="color:#EF4444;">100%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Breach Type</div>
                    <div class="stat-value" style="color:#EF4444; font-size:0.85rem;">Integrity</div>
                </div>
            </div>
        </div>

        <!-- Operational Symptoms -->
        <div class="rounded-xl flex-1 p-4"
             style="background:rgba(0,0,0,0.4); backdrop-filter:blur(8px); border:1px solid rgba(6,182,212,0.15);">
            <div class="flex items-center gap-2 mb-3 mono-font"
                 style="font-size:0.75rem; font-weight:700; color:rgba(148,163,184,0.7); text-transform:uppercase; letter-spacing:0.08em; border-bottom:1px solid rgba(6,182,212,0.1); padding-bottom:0.5rem;">
                <span class="pulse-dot"></span>Operational Symptoms
            </div>
            <ul class="space-y-3">
                <li class="flex items-start gap-2.5">
                    <i class="fas fa-times-circle mt-0.5 flex-shrink-0" style="color:rgba(148,163,184,0.35);"></i>
                    <p style="color:rgba(148,163,184,0.8); font-size:0.88rem; margin:0; line-height:1.5;">Miner logs show no errors — the injected messages are valid JSON-RPC.</p>
                </li>
                <li class="flex items-start gap-2.5">
                    <i class="fas fa-times-circle mt-0.5 flex-shrink-0" style="color:rgba(148,163,184,0.35);"></i>
                    <p style="color:rgba(148,163,184,0.8); font-size:0.88rem; margin:0; line-height:1.5;">Legitimate pool sees the miner go offline or idle — no shares arrive.</p>
                </li>
                <li class="flex items-start gap-2.5">
                    <i class="fas fa-check-circle mt-0.5 flex-shrink-0" style="color:#EF4444;"></i>
                    <p style="color:rgba(148,163,184,0.8); font-size:0.88rem; margin:0; line-height:1.5;">Attacker's pool receives valid shares funded by the victim's electricity.</p>
                </li>
            </ul>
        </div>

    </div>

</div>
</div>
<script src="slides.js"></script>
<script src="navigate.js"></script>
</body>
</html>
